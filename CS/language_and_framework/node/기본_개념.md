# Node.js

## 기본 개념

### Node.js란?

> Node.js®는 Chrome V8 JavaScript 엔진으로 빌드된 JavaScript 런타임입니다.
>
> [Node.js 공식 홈페이지](https://nodejs.org/ko/)

* 노드는 다양한 js 애플리케이션을 실행하게 해주지만, 주로 서버 애플리케이션을 실행하는데 사용된다.
* 노드는 *V8* 엔진과 *libuv*라는 라이브러리f로 구성됨. 둘 다 C++로 구현되어 있음(V8은 70% 정도).
  * 이 중 *libuv* 는 노드의 특성인 이벤트 기반, 논 블로킹 I/O 모델을 구현하고 있음



### 이벤트 기반

* 이벤트 기반이란 클릭과 같은 이벤트가 발생할 때 미리 지정한 작업을 수행하는 방식 

* 사전에 이벤트 리스너에 콜백 함수를 등록해놔야 함

  * 이벤트가 발생하면 이벤트 리스너에 등록된 콜백 호출, 이벤트가 없으면 대기

* **이벤트 루프**

  * 콜 스택, 백그라운드, 태스크 큐 사이의 루프
    * 이벤트 발생 시 호출할 콜백들을 관리, 실행 순서를 결정.
    * 노드가 종료될 때까지 이벤트 처리를 위한 작업을 반복함(루프)
  * 자바스크립트는 싱글스레드지만 V8 엔진의 콜 스택과 브라우저 혹은 node.js 의 libuv가 이를 가능하게 한다.

* **백그라운드**

  * 타이머나 이벤트 리스너들이 대기하는 곳

* **태스크 큐**

  * 콜백들이 있는 큐. 이벤트 발생 후 백그라운드에서 태스크 큐로 콜백 함수를 보냄.
  * 호출 스택이 비어있을 때 콜백을 호출 스택으로 보냄

* 예제

  ```javascript
  funciton run()  {
    console.log('3초 후 실행');
  }
  console.log('시작');
  setTimeout(run, 3000);
  console.log('끝');
  
  // 시작
  // 끝
  // 3초 후 실행
  ```

  * 위 코드의 결과는 기본적인 호출 스택과 다른 이벤트 루프의 처리 결과를 보여준다.



* 노드.js 와 그냥 자바스크립트에서의 이벤트 루프 비교
  * 백그라운드? 태스크 큐
  * web api? 콜백 큐